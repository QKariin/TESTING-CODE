<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.6">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #000000}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #000000; min-height: 14.0px}
    span.s1 {font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE html&gt;</span></p>
<p class="p1"><span class="s1">&lt;html lang="en"&gt;</span></p>
<p class="p1"><span class="s1">&lt;head&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;meta charset="UTF-8" /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;title&gt;Task Dom ðŸ–¤ Slave UI&lt;/title&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;!-- Your new clean link --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;link rel="stylesheet" href="style.css"&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;!-- Make sure this font link is still here too! --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&amp;family=Rajdhani:wght@500;600;700&amp;family=Rubik+Glitch&amp;family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet" /&gt;</span></p>
<p class="p1"><span class="s1">&lt;/head&gt;</span></p>
<p class="p1"><span class="s1">&lt;body&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;!-- SOUND --&gt;</span></p>
<p class="p1"><span class="s1">&lt;audio id="msgSound" src="https://assets.mixkit.co/active_storage/sfx/2354/2354-preview.mp3"&gt;&lt;/audio&gt;</span></p>
<p class="p1"><span class="s1">&lt;audio id="coinSound" src="https://assets.mixkit.co/active_storage/sfx/2019/2019-preview.mp3"&gt;&lt;/audio&gt;</span></p>
<p class="p1"><span class="s1">&lt;audio id="skipSound" src="https://static.wixstatic.com/mp3/ce3e5b_3b5b34d4083847e2b123b6fd9a8551fd.mp3"&gt;&lt;/audio&gt;</span></p>
<p class="p1"><span class="s1">&lt;audio id="sfx-buy" src="https://assets.mixkit.co/active_storage/sfx/2019/2019-preview.mp3"&gt;&lt;/audio&gt;</span></p>
<p class="p1"><span class="s1">&lt;audio id="sfx-deny" src="https://assets.mixkit.co/active_storage/sfx/2578/2578-preview.mp3"&gt;&lt;/audio&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;div id="celebrationOverlay" style="position:fixed;inset:0;pointer-events:none;z-index:9999;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity 0.3s;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="glass-card" style="border: 2px solid var(--neon-green); text-align:center;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div style="font-size:1.8rem;font-weight:900;color:var(--neon-green);text-shadow:0 0 20px var(--neon-green);"&gt;TASK&lt;br&gt;SUBMITTED&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;svg style="display:none;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;symbol id="icon-coin" viewBox="0 0 24 24"&gt;&lt;path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1.41 16.09V20h-2.67v-1.93c-1.71-.36-3.16-1.46-3.27-3.4h1.96c.1 1.05.69 1.64 1.83 1.64 1.22 0 1.6-.64 1.6-1.26 0-.81-.42-1.22-2.34-1.67-2.37-.59-3.54-1.7-3.54-3.41 0-1.68 1.29-2.94 3.28-3.29V4h2.66v1.93c1.61.27 2.87 1.28 3.01 3.05h-1.95c-.14-.99-.68-1.55-1.7-1.55-1.04 0-1.55.56-1.55 1.15 0 .75.46 1.2 2.37 1.65 2.51.6 3.58 1.74 3.58 3.52 0 1.82-1.46 3.09-3.28 3.34z"/&gt;&lt;/symbol&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;symbol id="icon-star" viewBox="0 0 24 24"&gt;&lt;path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/&gt;&lt;/symbol&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;symbol id="icon-send" viewBox="0 0 24 24"&gt;&lt;path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/&gt;&lt;/symbol&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;symbol id="icon-check" viewBox="0 0 24 24"&gt;&lt;path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/&gt;&lt;/symbol&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;symbol id="icon-close" viewBox="0 0 24 24"&gt;&lt;path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 17.59 13.41 12z"/&gt;&lt;/symbol&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;symbol id="icon-timer" viewBox="0 0 24 24"&gt;&lt;path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/&gt;&lt;/symbol&gt;</span></p>
<p class="p1"><span class="s1">&lt;/svg&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;input type="file" id="profileUploadInput" accept="image/*" class="hidden" onchange="handleProfileUpload(this)"&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;div class="app-container"&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;!-- TOP SECTION --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="top-section-split"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;!-- LEFT: PROFILE &amp; NAV --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="layout-left"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div class="glass-card profile-card"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="pc-avatar-section"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="pc-avatar-box" onclick="document.getElementById('profileUploadInput').click()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;img id="profilePic" src="" class="pc-avatar-img"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="pc-avatar-edit-overlay"&gt;&lt;span style="font-size:1.5rem; color:white;"&gt;âœŽ&lt;/span&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="pc-info-wrapper"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="subName" class="pc-name"&gt;SLAVE&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="subHierarchy" class="pc-rank"&gt;LOADING...&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="level-progress-container"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="lp-labels"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;span&gt;NEXT: &lt;span id="nextLevelName" style="color:white;"&gt;-&lt;/span&gt;&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;span id="pointsNeeded"&gt;0 to go&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="lp-bar-bg"&gt;&lt;div id="progressBar" class="lp-bar-fill"&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;!-- --- NEW DEVOTION SECTION --- --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="devotion-wrapper"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;!-- THE HYBRID BUTTON --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="btn" class="kneel-btn-bar" onclick="handleClick()" style="position: relative; display: block;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;!-- ANIMATION LAYER (The Fill) --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;span id="fill" class="bar-fill" style="display: block; position: absolute; top: 0; left: 0; height: 100%; z-index: 1;"&gt;&lt;/span&gt;<span class="Apple-converted-space">Â </span></span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;!-- TEXT LAYER (The Labels) --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="bar-text" style="position: relative; z-index: 2; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; pointer-events: none;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;span id="txt-main" style="font-size: 0.85rem; font-weight: 900; color: grey;"&gt;KNEEL&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;span id="txt-sub" style="font-size: 0.45rem; color: #888; font-family: 'Rajdhani';"&gt;TODAY KNEELING: 0&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;!-- DAILY ID --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="daily-id-display"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>DAILY ID: &lt;span id="dailyRandomId" class="did-val"&gt;#----&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;!-- STATS GRID UPDATED WITH ICONS/LABELS --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="pc-stats-grid"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="stat-single-row row-score" style="display: flex; align-items: baseline; justify-content: center; gap: 8px;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="points" class="ssr-val"&gt;0&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="ssr-lbl"&gt;POINTS&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="stat-single-row row-coins" style="align-items: center; justify-content: center; gap: 8px;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="coins" class="ssr-val"&gt;0&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;svg style="width:20px; height:20px; fill:var(--neon-yellow); filter:drop-shadow(0 0 5px rgba(255, 215, 0, 0.6));"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;use href="#icon-coin"&gt;&lt;/use&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/svg&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="stats-toggle-btn" onclick="toggleStats()"&gt;STATS â–¾&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;!-- STATS DROPDOWN UPDATED WITH SLAVE SINCE --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="statsContent"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="stat-row-group"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="stat-header" style="text-align: center;"&gt;SLAVE'S ACTIVITY&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="stat-line"&gt;&lt;span&gt;Task Streak&lt;/span&gt; &lt;strong id="statStreak"&gt;0&lt;/strong&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="stat-line"&gt;&lt;span&gt;Total Tasks&lt;/span&gt; &lt;strong id="statTotal"&gt;0&lt;/strong&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="stat-line"&gt;&lt;span&gt;Completed&lt;/span&gt; &lt;strong id="statCompleted"&gt;0&lt;/strong&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="stat-line"&gt;&lt;span&gt;Skipped&lt;/span&gt; &lt;strong id="statSkipped"&gt;0&lt;/strong&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="stat-line"&gt;&lt;span&gt;Total Kneeling&lt;/span&gt; &lt;strong id="statTotalKneels"&gt;0&lt;/strong&gt;&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;!-- Centered Slave Since Section --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div style="text-align: center; border-top: 1px solid #333; margin-top: 10px; padding-top: 10px; display: flex; flex-direction: column; align-items: center;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="stat-header" style="border:none; margin:0; padding:0; font-size: 0.65rem;"&gt;SLAVE SINCE&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;strong id="slaveSinceDate" style="font-size: 0.85rem; color: white; display: block; margin-top: 2px;"&gt;--/--/--&lt;/strong&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div class="nav-tabs"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;button class="tab-btn active" onclick="switchTab('serve')"&gt;HOME&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;button class="tab-btn nav-togglable" onclick="switchTab('news')"&gt;QKARIN&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;button class="tab-btn nav-togglable" onclick="switchTab('tribute')"&gt;TRIBUTE&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;button id="nav-btn-session" class="tab-btn nav-togglable" onclick="switchTab('session')"&gt;BUY SESSION&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;button class="tab-btn nav-togglable" onclick="switchTab('rewards')"&gt;REWARDS&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;button class="tab-btn nav-togglable" onclick="switchTab('protocol')"&gt;PROTOCOL&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;button class="tab-btn btn-foot-bank nav-togglable" onclick="switchTab('buy')"&gt;BUY COINS&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;!-- RIGHT: DYNAMIC CONTENT --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="layout-right"&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;!-- VIEW 1: HOME (TASKS &amp; CHAT) --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div id="viewServingTop" style="display:flex; flex-direction:column; gap:15px;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;!-- Task Card --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="taskCard" class="glass-card"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="activeBadge"&gt;ACTIVE TASK&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="taskContent" style="width: 100%; padding: 10px 0; text-align: center; flex-grow: 1; display:flex; flex-direction:column; justify-content:center;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;h2 id="readyText" style="font-weight:bold; margin-bottom:5px; color:white; font-size:1.5rem;"&gt;Ready?&lt;/h2&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;p class="rajdhani" style="color:#aaa; margin:0;"&gt;Waiting for orders.&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="cooldownSection" class="hidden" style="width: 100%; display:flex; flex-direction:column; align-items:center; text-align:center; padding-bottom: 10px;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="timerDisplay" style="font-size:2rem; font-weight:bold; margin:5px 0; color:white; text-shadow: 0 0 10px rgba(255,255,255,0.3);"&gt;24:00:00&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;input type="file" id="evidenceInput" accept="image/*,video/*" class="hidden" onchange="handleEvidenceUpload(this)"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;button onclick="document.getElementById('evidenceInput').click()" class="action-btn btn-upload"&gt;UPLOAD PROOF&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;button onclick="cancelPendingTask()" id="btnSkip" style="background:transparent; border:none; color:#ddd; margin-top:10px; font-size:0.7rem; cursor:pointer; text-transform:uppercase;"&gt;Skip / Cancel&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="uploadStatus" style="height:15px; font-size:0.7rem; color:#888; margin-top:5px;"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="mainButtonsArea" style="width:100%; margin-top:auto;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;button id="newTaskBtn" onclick="getRandomTask()" class="action-btn" style="width: 50%; margin: 0 auto; display: block;"&gt;REQUEST TASK&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;!-- Chat Card --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="chatCard" class="glass-card"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="chatBadge"&gt;CHAT&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="sessionOverlay"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div onclick="closeSessionUI()" style="position:absolute; top:15px; right:15px; color:var(--neon-green); font-size:1.5rem; font-weight:bold; cursor:pointer; line-height:1; z-index:100;"&gt;Ã—&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div style="padding: 20px; color: white; width: 100%; max-width: 400px; text-align: center;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;h2 style="font-family:'Rubik Glitch'; font-size: 2rem; color: var(--neon-pink); margin-bottom: 20px;"&gt;REQUEST SESSION&lt;/h2&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div style="margin-bottom: 20px; text-align: left;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;label style="display:block; margin-bottom:10px; font-weight:bold; color:#ccc; font-size: 0.7rem; letter-spacing: 1px;"&gt;SESSION TYPE&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="session-opt-group"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;label class="session-radio-label"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;input type="radio" name="sessionType" value="chat" data-cost="3000" class="session-radio-input" onchange="updateSessionCost()" checked&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;span class="s-lbl-title"&gt;CHAT&lt;/span&gt;&lt;span class="s-lbl-cost"&gt;3000 ðŸª™&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;label class="session-radio-label"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;input type="radio" name="sessionType" value="video" data-cost="5000" class="session-radio-input" onchange="updateSessionCost()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;span class="s-lbl-title"&gt;VIDEO&lt;/span&gt;&lt;span class="s-lbl-cost"&gt;5000 ðŸª™&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div style="margin-bottom: 20px; text-align: left;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;label style="display:block; margin-bottom:10px; font-weight:bold; color:#ccc; font-size: 0.7rem; letter-spacing: 1px;"&gt;FOCUS / KINK&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;select id="sessionFocus" style="width:100%; background:#111; border:1px solid #444; color:white; padding:10px; border-radius:8px; font-family:'Rajdhani'; outline:none;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;option value="JEI"&gt;JEI&lt;/option&gt;&lt;option value="CEI"&gt;CEI&lt;/option&gt;&lt;option value="SPH"&gt;SPH&lt;/option&gt;&lt;option value="HUMILIATION"&gt;HUMILIATION&lt;/option&gt;&lt;option value="EXPOSING"&gt;EXPOSING&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/select&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div style="margin-bottom: 20px; text-align: left;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;label style="display:block; margin-bottom:10px; font-weight:bold; color:#ccc; font-size: 0.7rem; letter-spacing: 1px;"&gt;TIME (TODAY)&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;select id="sessionTimeSelect" style="width:100%; background:#111; border:1px solid #444; color:white; padding:10px; border-radius:8px; font-family:'Rajdhani'; outline:none;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;option value="NOW"&gt;Now (Within 10m)&lt;/option&gt;&lt;option value="30MIN"&gt;In 30 Minutes&lt;/option&gt;&lt;option value="1HOUR"&gt;In 1 Hour&lt;/option&gt;&lt;option value="3HOURS"&gt;In 3 Hours&lt;/option&gt;&lt;option value="6HOURS"&gt;In 6 Hours&lt;/option&gt;&lt;option value="LATER"&gt;Later Today (Discuss in Chat)&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/select&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div style="margin-top: 30px;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div style="font-size:0.8rem; color:#888; margin-bottom:10px;"&gt;HOLD AMOUNT: &lt;span id="sessionCostDisplay" style="color:var(--neon-yellow); font-weight:bold;"&gt;3000&lt;/span&gt; ðŸª™&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div style="display:flex; gap: 10px;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;button onclick="submitSessionRequest()" class="action-btn" style="background:var(--neon-pink); border:none; width:100%;"&gt;CONFIRM REQUEST&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="specialGlassOverlay" onclick="breakGlass(event)" ontouchstart="breakGlass(event)"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;img src="https://static.wixstatic.com/media/ce3e5b_b75c0e95797b4ba8abe4198a83b6c9ae~mv2.gif" class="broken-glass-img" alt="Break Glass"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="chat-header-row"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="chat-avatar-container"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="chatStatusRing" class="dom-status-ring ring-inactive"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;img src="https://static.wixstatic.com/media/ce3e5b_1bd27ba758ce465fa89a36d70a68f355~mv2.png" class="chat-header-img"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="chat-header-info"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="chat-header-title"&gt;QUEEN KARIN&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="chatStatusBadge" class="chat-status-text"&gt;LAST SEEN: TODAY&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;button id="chatSessionBtn" onclick="openSessionUI()"&gt;&lt;span&gt;ðŸ“…&lt;/span&gt; REQUEST SESSION&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="chat-area" id="chatBox"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;button id="chatLoadMoreBtn" onclick="loadMoreChat()" style="display:none; width: 100%; background: transparent; color: #666; font-size: 0.7rem; border: none; padding: 5px; cursor: pointer; text-transform: uppercase; margin-bottom: 10px;"&gt;â–² Load Older Messages&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="chatContent"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="coin-presets-row"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;button class="coin-btn" onclick="sendCoins(500)"&gt;500 &lt;svg style="width:12px;height:12px;"&gt;&lt;use href="#icon-coin"&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;button class="coin-btn" onclick="sendCoins(1000)"&gt;1000 &lt;svg style="width:12px;height:12px;"&gt;&lt;use href="#icon-coin"&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;button class="coin-btn" onclick="sendCoins(2000)"&gt;2000 &lt;svg style="width:12px;height:12px;"&gt;&lt;use href="#icon-coin"&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;button class="coin-btn" onclick="sendCoins(5000)"&gt;5000 &lt;svg style="width:12px;height:12px;"&gt;&lt;use href="#icon-coin"&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="chat-input-row"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="plusMenu" class="d-none"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;label class="menu-btn" for="adminMediaInput"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;svg viewBox="0 0 24 24"&gt;&lt;path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/&gt;&lt;/svg&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>Photo/Video</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;input type="file" id="adminMediaInput" accept="image/*,video/*" class="hidden-input" onchange="handleAdminUpload(this)"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;button class="btn-plus" onclick="document.getElementById('adminMediaInput').click()"&gt;+&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;input type="text" id="chatMsgInput" class="chat-input" placeholder="Message..." onkeypress="handleChatKey(event)"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;button class="chat-send" onclick="sendChatMessage()"&gt;&lt;svg style="width:20px; height:20px; fill:black;"&gt;&lt;use href="#icon-send"&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;!-- CHAT MEDIA OVERLAY (Mobile Friendly) --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="chatMediaOverlay" onclick="closeChatPreview()" style="display:none; position:absolute; top:60px; bottom:70px; left:0; right:0; background:rgba(0,0,0,0.95); z-index:80; backdrop-filter:blur(5px); flex-direction:column; align-items:center; justify-content:center;"&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;!-- CLOSE BUTTON --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div style="position:absolute; top:10px; right:10px; color:white; font-size:2rem; font-weight:bold; cursor:pointer; z-index:90; padding:10px;"&gt;Ã—&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="cmoContent" style="width:100%; height:100%; display:flex; align-items:center; justify-content:center;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;!-- Media loads here --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;!-- VIEW 7: QKARIN (NEW SOCIAL PROFILE) --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div id="viewNews" class="hidden"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="glass-card" style="height: 100%; padding:0; overflow:hidden; background:#000;"&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="social-header"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="sh-avatar-frame"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;img src="https://static.wixstatic.com/media/ce3e5b_1bd27ba758ce465fa89a36d70a68f355~mv2.png" class="sh-avatar"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="sh-info"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="sh-name"&gt;QUEEN KARIN&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="sh-bio"&gt;Time to serve.&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="sh-stats"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="sh-stat-item"&gt;&lt;span class="sh-val" id="cntPosts"&gt;0&lt;/span&gt;&lt;span class="sh-lbl"&gt;POSTS&lt;/span&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="sh-stat-item"&gt;&lt;span class="sh-val"&gt;âˆž&lt;/span&gt;&lt;span class="sh-lbl"&gt;OWNER&lt;/span&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="domStatusBadge" class="sh-stat-item"&gt;&lt;span class="sh-val" style="color:var(--neon-green)"&gt;ONLINE&lt;/span&gt;&lt;span class="sh-lbl"&gt;STATUS&lt;/span&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="domVideoReel" class="highlights-rail"&gt;&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="feed-nav"&gt;&lt;div class="fn-btn active"&gt;GRID&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="newsGrid" class="social-grid"&gt;&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="streamContainer" class="video-container hidden" style="margin-top:20px;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;iframe id="twitchFrame" class="twitch-iframe" src="" allowfullscreen&gt;&lt;/iframe&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="streamLockOverlay" class="glass-lock-overlay"&gt;...&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;!-- OTHER VIEWS (Tribute, Session, Rewards, Hierarchy, Buy) --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div id="viewTribute" class="hidden"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="glass-card"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;h2 style="text-align:center; color:white; font-family:'Rubik Glitch', sans-serif; font-size:2rem; margin-bottom:15px; text-shadow:0 0 10px rgba(255,255,255,0.3);"&gt;THE STORE&lt;/h2&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="cat-scroll"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="cat-pill active" onclick="filterStore('all', this)"&gt;ALL&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="cat-pill" onclick="filterStore('little', this)"&gt;LITTLE&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="cat-pill" onclick="filterStore('middle', this)"&gt;MIDDLE&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="cat-pill" onclick="filterStore('big', this)"&gt;BIG&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="cat-pill" onclick="filterStore('naughty', this)"&gt;NAUGHTY&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="cat-pill" onclick="filterStore('freedom', this)"&gt;FREEDOM&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="storeGrid" class="store-grid"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div id="viewSession" class="hidden"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="glass-card" style="text-align:center; padding: 50px;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;h2 style="font-size:2rem; color:var(--neon-pink); text-shadow:0 0 10px var(--neon-pink);"&gt;PRIVATE SESSIONS&lt;/h2&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;p style="color:#aaa; font-family:'Rajdhani'; margin-top:10px;"&gt;Currently offline. Check back later.&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;button class="action-btn" style="margin-top:20px; opacity:0.5; cursor:not-allowed;"&gt;CHECK AVAILABILITY&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div id="viewProtocol" class="hidden"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="glass-card"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;h2 style="text-align:center; color:white; font-family:'Orbitron'; font-size:1.8rem; margin-bottom:20px; letter-spacing:2px;"&gt;OPERATIONAL PROTOCOL&lt;/h2&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div style="display:grid; grid-template-columns: 1fr; gap:10px;"&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="protocol-item" onclick="toggleSection(this)" style="border:1px solid var(--neon-yellow);"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;h3 class="protocol-header" style="color:var(--neon-yellow);"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div style="display:flex; align-items:center; gap:10px;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;svg style="width:18px; height:18px; fill:var(--neon-yellow);"&gt;&lt;use href="#icon-coin"&gt;&lt;/use&gt;&lt;/svg&gt;<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>THE ECONOMY</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;span class="protocol-arrow"&gt;â–¼&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/h3&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="protocol-content"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;p style="margin-bottom:10px;"&gt;&lt;strong style="color:white;"&gt;COINS (Currency):&lt;/strong&gt; Your physical worth. Used to buy gifts from the &lt;strong&gt;Wishlist&lt;/strong&gt;, pay mandatory tributes, or purchase your freedom from a task via the &lt;strong&gt;Skip&lt;/strong&gt; function.&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;p&gt;&lt;strong style="color:white;"&gt;POINTS (Status):&lt;/strong&gt; Your spiritual worth. Earned strictly through &lt;strong&gt;Kneeling&lt;/strong&gt; and completing &lt;strong&gt;Duties&lt;/strong&gt;. Points determine your rank in the &lt;strong&gt;Hierarchy&lt;/strong&gt;.&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="protocol-item" onclick="toggleSection(this)" style="border:1px solid var(--neon-green);"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;h3 class="protocol-header" style="color:var(--neon-green);"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div style="display:flex; align-items:center; gap:10px;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;svg style="width:18px; height:18px; fill:var(--neon-green);"&gt;&lt;path d="M7 2v11h3v9l7-12h-4l4-8z"/&gt;&lt;/svg&gt;<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>DUTY &amp; TASKS</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;span class="protocol-arrow"&gt;â–¼&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/h3&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="protocol-content"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;p style="margin-bottom:10px;"&gt;Click &lt;strong&gt;"REQUEST TASK"&lt;/strong&gt; to receive your orders.&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;ul style="list-style: none; padding-left: 0; color: #ccc;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;li style="margin-bottom:5px;"&gt;&lt;strong style="color:white;"&gt;- 24h Deadline:&lt;/strong&gt; Proof must be uploaded within 24 hours.&lt;/li&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;li&gt;&lt;strong style="color:white;"&gt;- Failure:&lt;/strong&gt; A &lt;strong&gt;300 COIN FINE&lt;/strong&gt; is applied automatically if the timer expires.&lt;/li&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/ul&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="protocol-item" onclick="toggleSection(this)" style="border:1px solid var(--neon-pink);"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;h3 class="protocol-header" style="color:var(--neon-pink);"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div style="display:flex; align-items:center; gap:10px;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;svg style="width:18px; height:18px; fill:var(--neon-pink);"&gt;&lt;path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/&gt;&lt;/svg&gt;<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>DEVOTION</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;span class="protocol-arrow"&gt;â–¼&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/h3&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="protocol-content"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;p&gt;Kneel once every &lt;strong&gt;60 minutes&lt;/strong&gt; via the profile bar. Consistency prevents rank degradation.&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="protocol-item" onclick="toggleSection(this)" style="border:1px solid #fff;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;h3 class="protocol-header" style="color:#fff;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div style="display:flex; align-items:center; gap:10px;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;svg style="width:18px; height:18px; fill:#fff;"&gt;&lt;path d="M12 2l2.4 4.9 5.4.8-3.9 3.8.9 5.4-4.8-2.5-4.8 2.5.9-5.4-3.9-3.8 5.4-.8z"/&gt;&lt;/svg&gt;<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>ROYAL HIERARCHY</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;span class="protocol-arrow"&gt;â–¼&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/h3&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="protocol-content"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;p style="margin-bottom:15px; font-size:0.8rem; color:#aaa;"&gt;Ranks are earned through total Points. Higher ranks unlock private session slots.&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="hierarchyGrid" class="grid gap-4"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="protocol-item" onclick="toggleSection(this)" style="border:1px solid #ff003c;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;h3 class="protocol-header" style="color:#ff003c;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div style="display:flex; align-items:center; gap:10px;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;svg style="width:18px; height:18px; fill:#ff003c;"&gt;&lt;path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/&gt;&lt;/svg&gt;<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>COMMANDS</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;span class="protocol-arrow"&gt;â–¼&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/h3&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="protocol-content"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;p&gt;&lt;strong style="color:white;"&gt;Glass Break:&lt;/strong&gt; Click the broken glass overlay immediately to read urgent commands.&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="protocol-item" onclick="toggleSection(this)" style="border:1px solid #666;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;h3 class="protocol-header" style="color:#ccc;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div style="display:flex; align-items:center; gap:10px;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;svg style="width:18px; height:18px; fill:#ccc;"&gt;&lt;path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/&gt;&lt;/svg&gt;<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>LAWS &amp; REGULATIONS</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;span class="protocol-arrow"&gt;â–¼&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/h3&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="protocol-content"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;ul style="list-style: none; padding: 0; margin: 0; color: #ccc;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;li style="margin-bottom: 8px;"&gt;&lt;strong style="color:white;"&gt;Section 1:&lt;/strong&gt; &lt;span id="r1"&gt;Loading...&lt;/span&gt;&lt;/li&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;li style="margin-bottom: 8px;"&gt;&lt;strong style="color:white;"&gt;Section 2:&lt;/strong&gt; &lt;span id="r2"&gt;Loading...&lt;/span&gt;&lt;/li&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;li style="margin-bottom: 8px;"&gt;&lt;strong style="color:white;"&gt;Section 3:&lt;/strong&gt; &lt;span id="r3"&gt;Loading...&lt;/span&gt;&lt;/li&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;li style="margin-bottom: 8px;"&gt;&lt;strong style="color:white;"&gt;Section 4:&lt;/strong&gt; &lt;span id="r4"&gt;Loading...&lt;/span&gt;&lt;/li&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;li style="margin-bottom: 8px;"&gt;&lt;strong style="color:white;"&gt;Section 5:&lt;/strong&gt; &lt;span id="r5"&gt;Loading...&lt;/span&gt;&lt;/li&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;li style="margin-bottom: 8px;"&gt;&lt;strong style="color:white;"&gt;Section 6:&lt;/strong&gt; &lt;span id="r6"&gt;Loading...&lt;/span&gt;&lt;/li&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;li style="margin-bottom: 8px;"&gt;&lt;strong style="color:white;"&gt;Section 7:&lt;/strong&gt; &lt;span id="r7"&gt;Loading...&lt;/span&gt;&lt;/li&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;li style="margin-bottom: 0px;"&gt;&lt;strong style="color:white;"&gt;Section 8:&lt;/strong&gt; &lt;span id="r8"&gt;Loading...&lt;/span&gt;&lt;/li&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/ul&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div id="viewRewards" class="hidden"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="glass-card" style="text-align:center; padding: 50px;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;h2 style="font-size:2rem; color:var(--neon-yellow); text-shadow:0 0 10px var(--neon-yellow);"&gt;REWARDS&lt;/h2&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;p style="color:#aaa; font-family:'Rajdhani'; margin-top:10px;"&gt;Unlock perks as you level up.&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div style="margin-top:20px; font-size: 3rem;"&gt;ðŸŽ&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div id="viewHierarchy" class="hidden"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="glass-card"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="text-center mb-4"&gt;&lt;h1 class="accent text-2xl md:text-4xl font-bold mb-1"&gt;ROYAL HIERARCHY&lt;/h1&gt;&lt;p class="text-gray-400 text-xs"&gt;Slave devotion ranks&lt;/p&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="grid gap-4" id="hierarchyGrid"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div id="viewBuy" class="hidden"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="glass-card"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;h2 style="text-align:center; color:var(--neon-yellow); font-family:'Rubik Glitch', sans-serif; font-size:2rem; margin-bottom:5px; text-shadow:0 0 10px rgba(255,215,0,0.3);"&gt;BUY COINS&lt;/h2&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;p style="text-align:center; color:#888; font-family:'Rajdhani'; font-size:0.8rem; margin-bottom:15px;"&gt;Purchase coins to pay tribute.&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="store-grid"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="store-item" style="border-color: var(--neon-yellow);"&gt;&lt;div class="si-img-box"&gt;&lt;svg style="width:40px; height:40px; fill:var(--neon-yellow);"&gt;&lt;use href="#icon-coin"&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/div&gt;&lt;div class="si-info"&gt;&lt;div class="si-name" style="color:white;"&gt;100 COINS&lt;/div&gt;&lt;button class="si-btn" style="background:rgba(255,215,0,0.1); border-color:var(--neon-yellow); color:var(--neon-yellow);" onclick="buyRealCoins(100)"&gt;â‚¬10.00&lt;/button&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="store-item" style="border-color: var(--neon-yellow);"&gt;&lt;div class="si-img-box"&gt;&lt;svg style="width:50px; height:50px; fill:var(--neon-yellow);"&gt;&lt;use href="#icon-coin"&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/div&gt;&lt;div class="si-info"&gt;&lt;div class="si-name" style="color:white;"&gt;500 COINS&lt;/div&gt;&lt;button class="si-btn" style="background:rgba(255,215,0,0.1); border-color:var(--neon-yellow); color:var(--neon-yellow);" onclick="buyRealCoins(500)"&gt;â‚¬50.00&lt;/button&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="store-item" style="border-color: var(--neon-yellow); box-shadow: 0 0 10px rgba(255,215,0,0.2);"&gt;&lt;div class="si-img-box"&gt;&lt;div style="position:absolute; font-size:2rem;"&gt;ðŸ’°&lt;/div&gt;&lt;/div&gt;&lt;div class="si-info"&gt;&lt;div class="si-name" style="color:white;"&gt;1000 COINS&lt;/div&gt;&lt;button class="si-btn" style="background:var(--neon-yellow); border-color:var(--neon-yellow); color:black; font-weight:bold;" onclick="buyRealCoins(1000)"&gt;â‚¬100.00&lt;/button&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="store-item" style="border-color: var(--neon-yellow);"&gt;&lt;div class="si-img-box"&gt;&lt;div style="position:absolute; font-size:2rem;"&gt;ðŸ’Ž&lt;/div&gt;&lt;/div&gt;&lt;div class="si-info"&gt;&lt;div class="si-name" style="color:white;"&gt;2500 COINS&lt;/div&gt;&lt;button class="si-btn" style="background:rgba(255,215,0,0.1); border-color:var(--neon-yellow); color:var(--neon-yellow);" onclick="buyRealCoins(2500)"&gt;â‚¬250.00&lt;/button&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="store-item" style="border-color: var(--neon-yellow);"&gt;&lt;div class="si-img-box"&gt;&lt;div style="position:absolute; font-size:2rem;"&gt;ðŸ‘‘&lt;/div&gt;&lt;/div&gt;&lt;div class="si-info"&gt;&lt;div class="si-name" style="color:white;"&gt;5000 COINS&lt;/div&gt;&lt;button class="si-btn" style="background:rgba(255,215,0,0.1); border-color:var(--neon-yellow); color:var(--neon-yellow);" onclick="buyRealCoins(5000)"&gt;â‚¬500.00&lt;/button&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="store-item" style="border-color: var(--neon-yellow);"&gt;&lt;div class="si-img-box"&gt;&lt;div style="position:absolute; font-size:2rem;"&gt;ðŸ¦&lt;/div&gt;&lt;/div&gt;&lt;div class="si-info"&gt;&lt;div class="si-name" style="color:white;"&gt;10k COINS&lt;/div&gt;&lt;button class="si-btn" style="background:rgba(255,215,0,0.1); border-color:var(--neon-yellow); color:var(--neon-yellow);" onclick="buyRealCoins(10000)"&gt;â‚¬1000.00&lt;/button&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div id="viewServingBottom" class="bottom-section-full"&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;!-- MODAL MOVED HERE: This traps it inside the section --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div id="glassModal" class="glass-modal" onclick="closeModal(event)"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;!-- LAYER 0: THE BACKGROUND PHOTO --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;div id="modalMediaContainer" class="modal-bg-photo"&gt;&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;!-- LAYER 1: TOP INFO (Status, Points, Sticker) --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;div id="modalOverlayInfo" class="modal-overlay-layer"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="modalStatus" class="m-status-badge"&gt;APPROVED&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="modalPoints" class="m-points-badge"&gt;+0 PTS&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="modalSticker" class="m-sticker-float"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;!-- LAYER 2: FEEDBACK BUBBLE (Floats in middle) --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;div id="modalFeedbackBubble" class="feedback-bubble hidden"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="bubble-label"&gt;QUEEN'S FEEDBACK&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="modalFeedbackMedia" class="bubble-media"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="modalFeedbackText" class="bubble-text"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;!-- LAYER 3: THE ORDER (Hidden by default) --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;div id="modalOrderText" class="order-overlay hidden"&gt;&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;!-- LAYER 4: ACTION BUTTONS (Bottom) --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;div class="modal-footer-actions"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>&lt;button onclick="toggleHistoryView('clear')" class="view-btn"&gt;SEE PHOTO&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>&lt;button onclick="toggleHistoryView('order')" class="view-btn"&gt;SEE ORDER&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>&lt;button onclick="toggleHistoryView('info')" class="view-btn"&gt;SEE STATUS&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>&lt;button onclick="closeModal(null)" class="view-btn close-btn"&gt;CLOSE&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;!-- EVIDENCE LOG HEADER (Now clean and separate) --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div style="display:flex; align-items:center; gap:8px; margin-bottom:10px; font-size:0.8rem; color:#fff; font-weight:bold; padding-left: 5px;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div style="width:6px; height:6px; background:var(--neon-yellow); border-radius:50%;"&gt;&lt;/div&gt; EVIDENCE LOG</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div id="pendingSection" style="display:none; width:100%;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div class="section-header"&gt;PENDING REVIEW&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div id="pendingGrid" class="pending-grid"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div id="historySection" style="display:none; width:100%;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div class="section-header"&gt;HISTORY&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div id="historyGrid" class="gallery-grid"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;button id="loadMoreBtn" onclick="loadMoreHistory()" class="action-btn" style="width: 200px; margin: 20px auto; display: none; background: #222; color: #888;"&gt;LOAD MORE&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const CLOUD_NAME = 'dfqvezjlj';<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const ACCOUNT_ID = 'kW2K8hR';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const API_KEY = 'public_kW2K8hR6YbQXStTvMf5ZDYbVf1fQ';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const UPLOAD_PRESET = 'task_uploads';<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const QUEEN_AVATAR = "https://static.wixstatic.com/media/ce3e5b_1bd27ba758ce465fa89a36d70a68f355~mv2.png";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const DEFAULT_AVATAR = "https://cdn-icons-png.flaticon.com/512/3233/3233508.png";<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const TWITCH_CHANNEL = "qkarin";<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const SESSION_VERSION = "v1";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const STREAM_PASSWORDS = ["QUEEN", "OBEY", "SESSION"];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let gameStats = { totalTasks: 0, completedTasks: 0, currentStreak: 0, points: 0, coins: 0 };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let stats = { approvedTasks: 0, rejectedTasks: 0, skippedTasks: 0, dailyCompletedTasks: 0, dailyStreak: 0, dailyScore: 0, monthlyTotalTasks: 0, monthlyScore: 0};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let userProfile = { name: "Slave", hierarchy: "Loading...", avatar: DEFAULT_AVATAR };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let currentTask = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let taskDatabase = [];<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let galleryData = [];<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let pendingTaskState = null;<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let taskJustFinished = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let cooldownInterval = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let ignoreBackendUpdates = false;<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let lastChatJson = "";<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let lastGalleryJson = "";<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let isInitialLoad = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let chatLimit = 10;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let lastNotifiedMessageId = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let historyLimit = 12;<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let pendingLimit = 4; <span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let currentView = 'serve';<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let resetUiTimer = null;<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let taskQueue = [];<span class="Apple-converted-space">Â </span></span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>/* --- RESTORED DATA --- */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const CMS_HIERARCHY = [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>{ Title: "Hall Boy", Icon: "ðŸ§¹", Order: 1, Points: "0+", Description: "Entry level of service.", StatusText: "First line of service.", ProtocolText: "Perform basic tasks.", DutiesText: "Prove you live to serve.", ContactText: "15MIN DAILY SLOT", CssClass: "" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>{ Title: "Footman", Icon: "ðŸš¶â€â™‚ï¸", Order: 2, Points: "2000+", Description: "Learn to serve.", StatusText: "Time to earn your place.", ProtocolText: "Serve quickly and reliably.", DutiesText: "Perfect Timing.", ContactText: "30MIN DAILY SLOT", CssClass: "" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>{ Title: "Silverman", Icon: "ðŸ´", Order: 3, Points: "5000+", Description: "Dedicated submissive.", StatusText: "Skilled and polished sub.", ProtocolText: "Focus on improvement.", DutiesText: "Face all challenges.", ContactText: "30MIN DAILY SLOT", CssClass: "" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>{ Title: "Butler", Icon: "ðŸ·", Order: 4, Points: "10000+", Description: "Trusted submissive.", StatusText: "Mastered consistency.", ProtocolText: "Notice needs without being told.", DutiesText: "Devotion is foundation.", ContactText: "DAILY 2x30min SLOTS", CssClass: "" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>{ Title: "Chamberlain", Icon: "ðŸ°", Order: 5, Points: "20000+", Description: "Senior submissive.", StatusText: "Act with excellence.", ProtocolText: "Carry yourself with dignity.", DutiesText: "Uphold standards.", ContactText: "UNLIMITED", CssClass: "Secretary" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>{ Title: "Secretary", Icon: "ðŸ“œ", Order: 6, Points: "50000+", Description: "Worthy of trust.", StatusText: "Inner Circle.", ProtocolText: "Respect and safeguard.", DutiesText: "Authority on smaller matters.", ContactText: "UNLIMITED", CssClass: "elite-butler" },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>{ Title: "Queen's Champion", Icon: "âš”ï¸", Order: 7, Points: "100000", Description: "Ultimate submissive!", StatusText: "You have made it!", ProtocolText: "2 bodies, 1 soul!", DutiesText: "Enjoy the love you earned.", ContactText: "LEGENDARY", CssClass: "legendary" }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>];</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>// Placeholder for CMS hierarchy data</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let cmsHierarchyData = null;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>// --- WISHLIST IS NOW EMPTY (LOADS FROM CMS) ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let WISHLIST_ITEMS = [];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const LEVELS = [{name: "HallBoy", min: 0}, {name: "Footman", min: 2000}, {name: "Silverman", min: 5000}, {name: "Butler", min: 10000}, {name: "Chamberlain", min: 20000}, {name: "Secretary", min: 50000}, {name: "Queen's Champioin", min: 100000}];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function getOptimizedUrl(url, width) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (!url) return "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (url.includes("cloudinary.com") &amp;&amp; url.includes("/upload/")) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>let cleanUrl = url.replace(/\.(mp4|webm|mov)$/i, ".jpg");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>return cleanUrl.replace("/upload/", `/upload/f_auto,q_auto,dpr_auto,c_limit,w_${width}/`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (url.includes("upcdn.io")) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>let cleanUrl = url.replace(/\.(mp4|webm|mov)$/i, ".jpg");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const sep = cleanUrl.includes("?") ? "&amp;" : "?";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>return `${cleanUrl}${sep}width=${width}&amp;format=auto&amp;quality=auto&amp;dpr=auto`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>return url;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const SafeStorage = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>setItem: (key, value) =&gt; { try { localStorage.setItem(key, value); } catch(e) {} },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>getItem: (key) =&gt; { try { return localStorage.getItem(key); } catch(e) { return null; } },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>removeItem: (key) =&gt; { try { localStorage.removeItem(key); } catch(e) {} }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function triggerSound(id) { const el = document.getElementById(id); if(el) { el.currentTime = 0; el.play().catch(e=&gt;{}); }<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>/* --- INIT --- */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>if(!userProfile.avatar) { document.getElementById('profilePic').src = DEFAULT_AVATAR; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const resizeObserver = new ResizeObserver(() =&gt; {<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(window.parent) window.parent.postMessage({ iframeHeight: document.body.scrollHeight }, '*');<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>resizeObserver.observe(document.body);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function initDomProfile() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const frame = document.getElementById('twitchFrame');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(frame &amp;&amp; !frame.src) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const parents = ["qkarin.com", "www.qkarin.com", "html-components.wixusercontent.com", "filesusr.com", "editor.wix.com", "manage.wix.com", "localhost"];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>let parentString = "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>parents.forEach(p =&gt; parentString += `&amp;parent=${p}`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>frame.src = `https://player.twitch.tv/?channel=${TWITCH_CHANNEL}${parentString}&amp;muted=true&amp;autoplay=true`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const savedSession = SafeStorage.getItem('taskDomStreamSession');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const savedExpiry = SafeStorage.getItem('taskDomStreamExpiry');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (savedSession === SESSION_VERSION &amp;&amp; savedExpiry &amp;&amp; parseInt(savedExpiry) &gt; Date.now()) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>document.getElementById('streamLockOverlay').classList.add('unlocked');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>SafeStorage.removeItem('taskDomStreamSession');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>SafeStorage.removeItem('taskDomStreamExpiry');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>document.getElementById('streamLockOverlay').classList.remove('unlocked');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>initDomProfile();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>/* --- MAIN LISTENER (DATABASE SYNC) --- */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>window.addEventListener("message", (event) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>const data = event.data;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>// FIX: Capture all 8 Rules from CMS safely</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>if (data.type === 'UPDATE_RULES') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>const rules = data.payload || {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>for (let i = 1; i &lt;= 8; i++) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>const el = document.getElementById('r' + i);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>if (el &amp;&amp; rules['rule' + i]) el.innerHTML = rules['rule' + i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>// CMS TASKS</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>if (data.type === "INIT_TASKS" || data.dailyTasks) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>if (data.dailyTasks &amp;&amp; Array.isArray(data.dailyTasks) &amp;&amp; data.dailyTasks.length &gt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>taskDatabase = data.dailyTasks;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>} else if (data.tasks) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>taskDatabase = data.tasks;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>// NEW: Listen for hierarchy from CMS</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>if (data.type === "INIT_HIERARCHY" || data.hierarchy) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>const incoming = data.hierarchy || data.hierarchyData;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>if (Array.isArray(incoming)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>cmsHierarchyData = incoming;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>else if (data.type === "INIT_WISHLIST" || data.wishlist) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (data.wishlist &amp;&amp; Array.isArray(data.wishlist) &amp;&amp; data.wishlist.length &gt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>WISHLIST_ITEMS = data.wishlist;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>renderWishlist('all');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>// DOM STATUS &amp; FEED</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>if (data.type === "UPDATE_DOM_STATUS") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>const badge = document.getElementById('chatStatusBadge');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>const ring = document.getElementById('chatStatusRing');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>const domBadge = document.getElementById('domStatusBadge');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>const domRing = document.getElementById('statusRing');</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>if(badge) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>badge.innerHTML = data.online ? "ONLINE" : data.text;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>badge.className = data.online ? "chat-status-text chat-online" : "chat-status-text";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>if(ring) ring.className = data.online ? "dom-status-ring ring-active" : "dom-status-ring ring-inactive";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>if(domBadge) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  </span>domBadge.innerHTML = data.online ? '&lt;span class="status-dot"&gt;&lt;/span&gt; ONLINE' : `&lt;span class="status-dot"&gt;&lt;/span&gt; ${data.text}`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  </span>domBadge.className = data.online ? "dom-status status-online" : "dom-status";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>if(domRing) domRing.className = data.online ? "dom-status-ring ring-active" : "dom-status-ring ring-inactive";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>// *** NEW LISTENER FOR FEED ***</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>if (data.type === "UPDATE_Q_FEED") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>if (data.domVideos &amp;&amp; Array.isArray(data.domVideos)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>renderDomVideos(data.domVideos);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>renderNews(data.domVideos);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>// UNIVERSAL DATA</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>const payload = data.profile || data.galleryData || data.pendingState ? data : null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>if (payload) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (payload.profile) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// 1. Spread all data (this captures gameStats.kneelCount from CMS)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>gameStats = { ...gameStats, ...payload.profile };</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>userProfile.name = payload.profile.name || "Slave";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>userProfile.hierarchy = payload.profile.hierarchy || "Newbie";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>userProfile.memberId = payload.profile.memberId || "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>userProfile.joined = payload.profile.joined;<span class="Apple-converted-space">Â </span></span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// --- KNEEL UPDATE SYNC ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (payload.profile.lastWorship) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>lastWorshipTime = new Date(payload.profile.lastWorship).getTime();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// 2. FIX: Connect to kneelCount field instead of points</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if(document.getElementById('kneelCount')) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>document.getElementById('kneelCount').innerText = payload.profile.kneelCount || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// 3. Force Update Button Visuals (now using kneelCount)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>updateDevotionStatus();<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// --------------------------</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>stats = { ...stats, ...payload.profile.stats }; <span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>stats = migrateGameStatsToStats(gameStats, stats);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if(payload.profile.profilePicture) {<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>userProfile.avatar = payload.profile.profilePicture;<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>document.getElementById('profilePic').src = getOptimizedUrl(userProfile.avatar, 150);<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>updateStats();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>if (payload.galleryData) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>let rawGallery = payload.galleryData;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>if (typeof rawGallery === 'string') { try { rawGallery = JSON.parse(rawGallery); } catch(e) { rawGallery = []; } }</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>if (Array.isArray(rawGallery)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>let serverGallery = rawGallery.filter(item =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (!item.status) return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const s = item.status.toLowerCase();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (s.includes('skip') || s.includes('fail') || s.includes('cancel')) return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (!item.proofUrl || item.proofUrl.length &lt; 5) return false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>return true;<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const currentGalleryJson = JSON.stringify(serverGallery);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (currentGalleryJson !== lastGalleryJson) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>lastGalleryJson = currentGalleryJson;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>galleryData = serverGallery;<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>renderGallery();<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>updateStats();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>if (payload.pendingState !== undefined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  </span>if (!taskJustFinished &amp;&amp; !ignoreBackendUpdates) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>pendingTaskState = payload.pendingState;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (pendingTaskState) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (!currentTask || currentTask.text !== pendingTaskState.task.text) {<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>currentTask = pendingTaskState.task;<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>restorePendingUI();<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>} else {<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (currentTask &amp;&amp; !document.getElementById('cooldownSection').classList.contains('hidden')) {<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>} else {<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>currentTask = null;<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if(!resetUiTimer) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>document.getElementById('cooldownSection').classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>document.getElementById('activeBadge').classList.remove('show');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>document.getElementById('mainButtonsArea').classList.remove('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>document.getElementById('taskContent').innerHTML = `&lt;h2 id="readyText" style="font-weight:bold; margin-bottom:5px; color:white; font-size:1.5rem;"&gt;Ready?&lt;/h2&gt;&lt;p class="rajdhani" style="color:#aaa; margin:0;"&gt;Waiting for orders.&lt;/p&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>if (data.type === "UPDATE_CHAT" || data.chatHistory) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>const msgs = data.chatHistory || data.messages;<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>if(msgs) renderChat(msgs);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>/* --- UI FUNCTIONS --- */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function switchTab(mode) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// 1. Highlight Active Button</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const allBtns = document.querySelectorAll('.tab-btn');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>allBtns.forEach(b =&gt; b.classList.remove('active'));</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>currentView = mode;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// Find and highlight the button for this mode</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>allBtns.forEach(btn =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (btn.getAttribute('onclick').includes(mode)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>btn.classList.add('active');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// 2. MOBILE LOGIC: Hide buttons if not on Home</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (window.innerWidth &lt; 768) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>allBtns.forEach(btn =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const cmd = btn.getAttribute('onclick') || "";</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (mode === 'serve') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// We are on HOME: Show everything</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>btn.classList.remove('nav-hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// We are on a SUB-PAGE: Hide everything first</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>btn.classList.add('nav-hidden');</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// Then SHOW only Home and Current</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (cmd.includes('serve') || cmd.includes(mode)) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>btn.classList.remove('nav-hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// 3. Switch Views (Standard logic)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>['viewServingTop','viewTribute','viewSession','viewRewards','viewHierarchy','viewNews','viewBuy','viewProtocol'].forEach(id =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const el = document.getElementById(id);<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if(el) el.classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(mode === 'serve') document.getElementById('viewServingTop').classList.remove('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(mode === 'tribute') document.getElementById('viewTribute').classList.remove('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(mode === 'session') document.getElementById('viewSession').classList.remove('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(mode === 'rewards') document.getElementById('viewRewards').classList.remove('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(mode === 'hierarchy') document.getElementById('viewHierarchy').classList.remove('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(mode === 'buy') document.getElementById('viewBuy').classList.remove('hidden');</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(mode === 'protocol') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>document.getElementById('viewProtocol').classList.remove('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// When opening the tab, ensure everything is visible</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>document.querySelectorAll('.protocol-item').forEach(item =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>item.style.display = 'block';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>item.classList.remove('active');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(mode === 'news') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>document.getElementById('viewNews').classList.remove('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>window.parent.postMessage({ type: "LOAD_Q_FEED" }, "*");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// Bottom Section logic (Evidence Log only on Home)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const bottom = document.getElementById('viewServingBottom');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(bottom) bottom.style.display = (mode === 'serve') ? 'block' : 'none';</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// Render Triggers</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(mode === 'hierarchy') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// FIX: Prioritize CMS hierarchy if available</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>renderHierarchy(cmsHierarchyData || CMS_HIERARCHY);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(mode === 'tribute') renderWishlist('all');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(mode === 'serve') renderGallery();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function toggleStats() { document.getElementById('statsContent').classList.toggle('open'); }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>/* --- TASK LOGIC --- */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function getRandomTask() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>ignoreBackendUpdates = true;<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (resetUiTimer) { clearTimeout(resetUiTimer); resetUiTimer = null; }</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>let taskText = "Waiting for orders...";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (taskQueue &amp;&amp; taskQueue.length &gt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>taskText = taskQueue[0];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (taskDatabase &amp;&amp; taskDatabase.length &gt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>taskText = taskDatabase[Math.floor(Math.random()*taskDatabase.length)];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>currentTask = { text: taskText, category: 'general', timestamp: Date.now() };<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const endTimeVal = Date.now() + 86400000;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>pendingTaskState = { task: currentTask, endTime: endTimeVal, status: "PENDING" };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>restorePendingUI();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>window.parent.postMessage({ type: "savePendingState", pendingState: pendingTaskState, consumeQueue: true }, "*");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>setTimeout(() =&gt; { ignoreBackendUpdates = false; }, 5000);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function restorePendingUI() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (resetUiTimer) { clearTimeout(resetUiTimer); resetUiTimer = null; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.getElementById('mainButtonsArea').classList.add('hidden');<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.getElementById('activeBadge').classList.add('show');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.getElementById('taskContent').innerHTML = `&lt;div style="font-size:1.2rem; font-weight:bold;"&gt;${currentTask.text}&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.getElementById('cooldownSection').classList.remove('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(cooldownInterval) clearInterval(cooldownInterval);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const targetTime = parseInt(pendingTaskState.endTime);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>cooldownInterval = setInterval(() =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  </span>if(!targetTime) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  </span>const diff = targetTime - Date.now();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  </span>if(diff &lt;= 0) {<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  </span>// --- AUTO FAIL LOGIC (300 COIN FINE) ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  </span>clearInterval(cooldownInterval);<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  </span>document.getElementById('timerDisplay').textContent="00:00:00";<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  </span>cancelPendingTask(); // This triggers the fine logic</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  </span>return;<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  </span>const h = Math.floor(diff/3600000).toString().padStart(2,'0');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  </span>const m = Math.floor((diff%3600000)/60000).toString().padStart(2,'0');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  </span>const s = Math.floor((diff%60000)/1000).toString().padStart(2,'0');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  </span>document.getElementById('timerDisplay').textContent = `${h}:${m}:${s}`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}, 1000);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function finishTask(success) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>taskJustFinished = true;<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>pendingTaskState = null;<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>clearInterval(cooldownInterval);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.getElementById('celebrationOverlay').classList.add('active');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>setTimeout(() =&gt; { document.getElementById('celebrationOverlay').classList.remove('active'); }, 2500);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>resetTaskDisplay(success);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>setTimeout(() =&gt; { taskJustFinished = false; ignoreBackendUpdates = false; }, 5000);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function cancelPendingTask() {<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(!currentTask) return;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// --- COIN CHECK (300 COIN FINE) ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (gameStats.coins &lt; 300) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  </span>triggerSound('sfx-deny');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  </span>// Fake system message</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  </span>const chatContent = document.getElementById('chatContent');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  </span>chatContent.innerHTML += `&lt;div class="msg-row system-row"&gt;&lt;div class="msg-system sys-red"&gt;&lt;svg class="sys-icon"&gt;&lt;use href="#icon-close"&gt;&lt;/use&gt;&lt;/svg&gt;CANNOT AFFORD SKIP (300)&lt;/div&gt;&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  </span>document.getElementById('chatBox').scrollTop = document.getElementById('chatBox').scrollHeight;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// ---------------------------------</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>triggerSound('skipSound');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>window.parent.postMessage({ type: "taskSkipped", taskTitle: currentTask.text }, "*");<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>finishTask(false);<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function resetTaskDisplay(success) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.getElementById('cooldownSection').classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.getElementById('activeBadge').classList.remove('show');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.getElementById('mainButtonsArea').classList.remove('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.getElementById('taskContent').innerHTML = `&lt;h2 style="font-weight:bold; font-size:1.5rem; color:${success?'var(--neon-yellow)':'var(--neon-red)'}"&gt;${success?'GOOD BOY.':'PATHETIC.'}&lt;/h2&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>currentTask = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (resetUiTimer) clearTimeout(resetUiTimer);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>resetUiTimer = setTimeout(() =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  </span>document.getElementById('taskContent').innerHTML = `&lt;h2 id="readyText" style="font-weight:bold; margin-bottom:5px; color:white; font-size:1.5rem;"&gt;Ready?&lt;/h2&gt;&lt;p class="rajdhani" style="color:#aaa; margin:0;"&gt;Waiting for orders.&lt;/p&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  </span>resetUiTimer = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}, 3000);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>/* --- CHAT LOGIC (FORCE BUBBLES + SCROLL FIX + ANTI BLINK) --- */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function renderChat(messages) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const chatBoxContainer = document.getElementById('chatBox');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const chatContent = document.getElementById('chatContent');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const loadMoreBtn = document.getElementById('chatLoadMoreBtn');</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(!messages) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>messages.sort((a,b) =&gt; new Date(a._createdDate) - new Date(b._createdDate));</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// Anti-Blink</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const currentJson = JSON.stringify(messages);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (currentJson === lastChatJson) return;<span class="Apple-converted-space">Â </span></span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const isAtBottom = (chatBoxContainer.scrollHeight - chatBoxContainer.scrollTop - chatBoxContainer.clientHeight) &lt; 150;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const wasInitialLoad = isInitialLoad;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (!isInitialLoad) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const lastMsg = messages[messages.length-1];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (lastMsg.sender !== 'user' &amp;&amp; lastMsg._id !== lastNotifiedMessageId) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>triggerSound('msgSound');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (lastMsg.sender === 'system' || document.activeElement !== document.getElementById('chatMsgInput')) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>document.getElementById('specialGlassOverlay').classList.add('active');<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>lastNotifiedMessageId = lastMsg._id;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>lastChatJson = currentJson; isInitialLoad = false;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>loadMoreBtn.style.display = messages.length &gt; chatLimit ? 'block' : 'none';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const visibleMessages = messages.slice(Math.max(messages.length - chatLimit, 0));</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>chatContent.innerHTML = visibleMessages.map(m =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>let txt = m.message.replace(/&lt;[^&gt;]+&gt;/g, "").trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const isMe = m.sender === 'user';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const isSystem = m.sender === 'system';</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// 1. SYSTEM MESSAGES (GREY DEFAULT)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (isSystem) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>let sysClass = ""; // Default Grey (transparent bg via CSS)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>let sysIcon = "#icon-check";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const lower = txt.toLowerCase();</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// ONLY Money is Gold</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (lower.includes("tribute") || lower.includes("coins") || lower.includes("purchase") || lower.includes("sent")) {<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>sysClass = "sys-gold"; sysIcon = "#icon-coin";<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// Errors Red</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>else if (lower.includes("insufficient") || lower.includes("poor") || lower.includes("rejected")) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>sysClass = "sys-red"; sysIcon = "#icon-close";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>txt = txt.replace(/âœ…|âŒ|â›”|ðŸŽ|ðŸª™/g, "").trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>return `&lt;div class="msg-row system-row"&gt;&lt;div class="msg-system ${sysClass}"&gt;&lt;svg class="sys-icon"&gt;&lt;use href="${sysIcon}"&gt;&lt;/use&gt;&lt;/svg&gt;${txt}&lt;/div&gt;&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// 2. ADMIN/USER MESSAGES</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>let msgClass = isMe ? 'm-slave' : 'm-queen';</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// Admin Verdict Colors</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (!isMe) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (txt.includes("Verified") || txt.includes("Task Verified")) msgClass = 'm-approve';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>else if (txt.includes("Rejected") || txt.includes("Task Rejected")) msgClass = 'm-reject';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>let contentHtml = `&lt;div class="msg ${msgClass}"&gt;${txt}&lt;/div&gt;`;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// 3. MEDIA DETECTION (Includes Video Fix)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (m.message.startsWith('http')) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const url = m.message;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const lowerUrl = url.toLowerCase();</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// Video Check</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const isVideo = lowerUrl.includes("#.mp4") || lowerUrl.match(/\.(mp4|webm|mov)($|\?)/) || m.type === 'video';</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// Image Check</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const isImage = !isVideo &amp;&amp; (</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>lowerUrl.match(/\.(jpeg|jpg|gif|png|webp|bmp)($|\?)/) ||<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>lowerUrl.includes("wixstatic") ||<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>lowerUrl.includes("cloudinary") ||<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>lowerUrl.includes("upcdn.io")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (isVideo) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>contentHtml = `&lt;div class="msg ${msgClass}" style="padding:0; background:black;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;video src="${url}" controls preload="metadata" onclick="openChatPreview('${encodeURIComponent(url)}', true)" style="max-width:100%; border-radius:8px; display:block; cursor:pointer;" onloadedmetadata="forceBottom()"&gt;&lt;/video&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>else if (isImage) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const encUrl = encodeURIComponent(url);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>contentHtml = `&lt;div class="msg ${msgClass}" style="padding:0;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;img src="${url}" class="gm-img" style="border-radius:8px; cursor:pointer;" loading="lazy" onclick="openChatPreview('${encUrl}', false)" onload="forceBottom()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>contentHtml = `&lt;div class="msg ${msgClass}"&gt;&lt;a href="${url}" target="_blank" rel="noopener noreferrer" style="text-decoration:underline;"&gt;LINK&lt;/a&gt;&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// Timestamp Layout (Side by Side)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>let rowContent = "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const avatar = isMe ? "" : `&lt;img src="${QUEEN_AVATAR}" class="msg-avatar"&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const timeDiv = `&lt;div class="msg-time"&gt;${new Date(m._createdDate).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}&lt;/div&gt;`;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (isMe) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  </span>rowContent = `&lt;div class="msg-col" style="justify-content: flex-end;"&gt;${contentHtml} ${timeDiv}&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  </span>rowContent = `${avatar}&lt;div class="msg-col" style="justify-content: flex-start;"&gt;${contentHtml} ${timeDiv}&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>return `&lt;div class="msg-row ${isMe?'mr-out':'mr-in'}"&gt;${rowContent}&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}).join('');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (wasInitialLoad || isAtBottom) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>forceBottom();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>setTimeout(forceBottom, 100);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>setTimeout(forceBottom, 500);<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>// --- FORCE SCROLL HELPER ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function forceBottom() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const b = document.getElementById('chatBox');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(b) b.scrollTop = b.scrollHeight;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>// --- PROTOCOL TOGGLE LOGIC (EXCLUSIVE FOCUS + ARROWS) ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function toggleSection(element) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const allItems = document.querySelectorAll('.protocol-item');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const isActive = element.classList.contains('active');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (!isActive) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// OPENING: Hide everything else completely</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>allItems.forEach(item =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (item === element) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>item.classList.add('active');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>item.style.display = 'block';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const itemArrow = item.querySelector('.protocol-arrow');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (itemArrow) itemArrow.innerText = 'â–²';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>item.style.display = 'none'; // They vanish</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// CLOSING: Show everything again</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>allItems.forEach(item =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>item.classList.remove('active');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>item.style.display = 'block'; // They return</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const itemArrow = item.querySelector('.protocol-arrow');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (itemArrow) itemArrow.innerText = 'â–¼';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>// --- NEW INTERNAL CHAT PREVIEW FUNCTIONS ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function openChatPreview(encUrl, isVideo) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const url = decodeURIComponent(encUrl);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const overlay = document.getElementById('chatMediaOverlay');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const content = document.getElementById('cmoContent');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (isVideo) { content.innerHTML = `&lt;video src="${url}" controls autoplay class="cmo-media" style="pointer-events:auto;"&gt;&lt;/video&gt;`; }<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>else { content.innerHTML = `&lt;img src="${url}" class="cmo-media"&gt;`; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>overlay.classList.add('active');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function closeChatPreview() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const overlay = document.getElementById('chatMediaOverlay');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>overlay.classList.remove('active');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.getElementById('cmoContent').innerHTML = "";<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function loadMoreChat() { chatLimit += 10; const oldJson = lastChatJson; lastChatJson = ""; renderChat(JSON.parse(oldJson)); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function sendChatMessage() { const input = document.getElementById('chatMsgInput'); const txt = input.value.trim(); if(!txt) return; window.parent.postMessage({ type: "SEND_CHAT_TO_BACKEND", text: txt }, "*"); input.value = ""; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function handleChatKey(e) { if(e.key === 'Enter') sendChatMessage(); }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function createPendingCardHTML(item) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const cleanText = cleanHTML(item.text).replace(/"/g, '&amp;quot;');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const isVideo = item.proofType === 'video' || item.proofUrl.match(/\.(mp4|webm|mov)$/i);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>let thumb = getOptimizedUrl(item.proofUrl, 400);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const encUrl = encodeURIComponent(item.proofUrl || "");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const encText = encodeURIComponent(item.text || "");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const encStatus = encodeURIComponent("PENDING REVIEW");</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>return `&lt;div class="pending-card" onclick='openModal("${encUrl}", "${encStatus}", "${encText}", ${isVideo}, "", "", "")'&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="pc-media"&gt;&lt;img src="${thumb}" class="pc-thumb" loading="lazy"&gt;&lt;div class="pc-gradient"&gt;&lt;/div&gt;&lt;div class="absolute inset-0 flex items-center justify-center z-10"&gt;&lt;svg class="w-8 h-8 fill-yellow-400 drop-shadow-md"&gt;&lt;use href="#icon-timer"&gt;&lt;/use&gt;&lt;/svg&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="pc-content"&gt;&lt;div class="pc-badge"&gt;PENDING&lt;/div&gt;&lt;div class="pc-title"&gt;${cleanText}&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>// Change the first line to include index</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>function createGalleryItemHTML(item, index) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>if(!item.proofUrl) return '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>let statusClass = item.status === 'approve' ? 'st-approve' : (item.status === 'reject' ? 'st-reject' : 'st-pending');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>let statusText = item.status === 'approve' ? 'APPROVED' : (item.status === 'reject' ? 'REJECTED' : 'PENDING');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>let overlayHtml = item.status === 'reject' ? '&lt;div class="rejected-overlay"&gt;&lt;/div&gt;' : '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>const isVideo = item.proofType === 'video' || item.proofUrl.match(/\.(mp4|webm|mov)$/i);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>let thumbUrl = getOptimizedUrl(item.proofUrl, 300);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>let mediaHtml = isVideo ? `&lt;img src="${thumbUrl}" class="gi-thumb" loading="lazy"&gt;&lt;div class="gi-play-icon" style="display:block;"&gt;â–¶&lt;/div&gt;` : `&lt;img src="${thumbUrl}" class="gi-thumb" style="opacity:0.7;" loading="lazy"&gt;`;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>let stickerHtml = item.sticker ? `&lt;img src="${item.sticker}" class="gi-sticker" title="Awarded"&gt;` : '';</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>// CHANGE: The onclick now calls openHistoryModal(index)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>return `&lt;div class="gallery-item ${isVideo?'video-item':''}" onclick='openHistoryModal(${index})'&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>${overlayHtml}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>${mediaHtml}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>${stickerHtml}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="gi-badge ${statusClass}"&gt;${statusText}&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>let currentHistoryIndex = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>let touchStartX = 0;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// 1. MAIN FUNCTION: Open Modal by Index with Layered UI</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>function openHistoryModal(index) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// Filter history items only</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const historyItems = galleryData.filter(i =&gt; (i.status === 'approve' || i.status === 'reject') &amp;&amp; i.proofUrl);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (historyItems.length === 0) return;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// --- LOOP LOGIC: Allows continuous swiping ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (index &lt; 0) index = historyItems.length - 1;<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (index &gt;= historyItems.length) index = 0; <span class="Apple-converted-space">Â  Â </span></span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>currentHistoryIndex = index;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const item = historyItems[index];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// Detect media type for background</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const isVideo = item.proofType === 'video' || (item.proofUrl &amp;&amp; item.proofUrl.match(/\.(mp4|webm|mov)$/i));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// LAYER 0: Set Background Media</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const mediaContainer = document.getElementById('modalMediaContainer');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (mediaContainer) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>mediaContainer.innerHTML = isVideo ?</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>`&lt;video src="${item.proofUrl}" autoplay loop muted style="width:100%; height:100%; object-fit:cover;"&gt;&lt;/video&gt;` :</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>`&lt;img src="${item.proofUrl}" style="width:100%; height:100%; object-fit:cover;"&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// LAYER 1: Set Status Badge &amp; Points</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const statusEl = document.getElementById('modalStatus');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (statusEl) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>statusEl.innerText = (item.status || "STATUS").toUpperCase();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>statusEl.style.backgroundColor = item.status === 'approve' ? 'var(--neon-green)' : 'var(--neon-red)';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const pointsEl = document.getElementById('modalPoints');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (pointsEl) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>pointsEl.innerText = `+${item.points || 0} PTS`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// LAYER 1.5: Set Sticker</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const stickerEl = document.getElementById('modalSticker');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (stickerEl) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>stickerEl.innerHTML = item.sticker ? `&lt;img src="${item.sticker}" style="width:60px; filter:drop-shadow(0 0 5px white);"&gt;` : "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// LAYER 2: Set Feedback Bubble (Small floating bubble)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const bubble = document.getElementById('modalFeedbackBubble');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const fMedia = document.getElementById('modalFeedbackMedia');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const fText = document.getElementById('modalFeedbackText');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (bubble) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (item.adminComment || item.adminMedia) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>bubble.classList.remove('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (fText) fText.innerText = item.adminComment || "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (fMedia) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (item.adminMedia) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const isAdmVideo = item.adminMedia.match(/\.(mp4|webm|mov)$/i);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>fMedia.innerHTML = isAdmVideo ?</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>`&lt;video src="${item.adminMedia}" controls style="max-height:100px; border-radius:8px; width:auto;"&gt;&lt;/video&gt;` :</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>`&lt;img src="${item.adminMedia}" style="max-height:100px; border-radius:8px; width:auto;"&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>} else { fMedia.innerHTML = ""; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>bubble.classList.add('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// LAYER 3: Set Order Overlay Text</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const orderEl = document.getElementById('modalOrderText');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (orderEl) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>orderEl.innerText = item.text || "No details available.";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// Reset view to 'info' state whenever a new photo opens</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>toggleHistoryView('info');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// Show the Modal</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const glassModal = document.getElementById('glassModal');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (glassModal) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>glassModal.classList.add('active');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>glassModal.style.display = 'flex';<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// 2. VIEW CONTROLLER: Logic for "See Order", "See Photo", etc.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>function toggleHistoryView(view) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const infoLayer = document.getElementById('modalOverlayInfo');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const feedbackBubble = document.getElementById('modalFeedbackBubble');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const orderOverlay = document.getElementById('modalOrderText');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (!infoLayer || !orderOverlay) return;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// Default: Hide all floating layers</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>infoLayer.style.display = "none";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (feedbackBubble) feedbackBubble.style.display = "none";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>orderOverlay.classList.add('hidden');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (view === 'info') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// Show Status, Points, Sticker, and Feedback</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>infoLayer.style.display = "flex";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (feedbackBubble &amp;&amp; feedbackBubble.innerHTML.trim() !== "") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>feedbackBubble.style.display = "block";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>} else if (view === 'order') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// Show only the Task Description centered</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>orderOverlay.classList.remove('hidden');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// 'clear' view leaves everything hidden (See Photo only)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// 3. SWIPE DETECTION: Core Listeners</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const modalEl = document.getElementById('glassModal');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>modalEl.addEventListener('touchstart', e =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>touchStartX = e.changedTouches[0].screenX;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}, { passive: true });</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>modalEl.addEventListener('touchend', e =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const touchEndX = e.changedTouches[0].screenX;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const diff = touchStartX - touchEndX;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// 70px threshold to verify swipe vs tap</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (Math.abs(diff) &gt; 70) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (diff &gt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>openHistoryModal(currentHistoryIndex + 1); // Swipe Left -&gt; Next</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>openHistoryModal(currentHistoryIndex - 1); // Swipe Right -&gt; Prev</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}, { passive: true });</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function renderGallery() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const pGrid = document.getElementById('pendingGrid');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const hGrid = document.getElementById('historyGrid');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const pItems = galleryData.filter(i =&gt; i.status === 'pending' &amp;&amp; i.proofUrl);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(pGrid) pGrid.innerHTML = pItems.slice(0, pendingLimit).map(createPendingCardHTML).join('');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.getElementById('pendingSection').style.display = pItems.length &gt; 0 ? 'block' : 'none';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const hItems = galleryData.filter(i =&gt; (i.status === 'approve' || i.status === 'reject') &amp;&amp; i.proofUrl);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(hGrid) hGrid.innerHTML = hItems.slice(0, historyLimit).map((item, index) =&gt; createGalleryItemHTML(item, index)).join('');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.getElementById('historySection').style.display = (hItems.length &gt; 0 || pItems.length === 0) ? 'block' : 'none';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.getElementById('loadMoreBtn').style.display = hItems.length &gt; historyLimit ? 'block' : 'none';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function loadMoreHistory() { historyLimit += 25; renderGallery(); }</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â </span></span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function openModal(encUrl, encStatus, encText, isVideo, encComment, encMedia, encSticker) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.querySelector('.gm-content').style.maxWidth = "900px";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const mediaZone = document.getElementById('modalMediaContainer');</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const url = decodeURIComponent(encUrl);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const status = decodeURIComponent(encStatus);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const text = decodeURIComponent(encText);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const adminComment = encComment ? decodeURIComponent(encComment) : "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const adminMedia = encMedia ? decodeURIComponent(encMedia) : "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const sticker = encSticker ? decodeURIComponent(encSticker) : "";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>let statusColor = "#888";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>let statusShadow = "none";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (status.includes("APPROVED")) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>statusColor = "var(--neon-green)"; statusShadow = "0 0 15px var(--neon-green)";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>} else if (status.includes("REJECTED")) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>statusColor = "var(--neon-red)"; statusShadow = "0 0 15px var(--neon-red)";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>mediaZone.style.display = "flex";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>mediaZone.innerHTML = isVideo ? `&lt;video src="${url}" class="gm-img" controls autoplay&gt;&lt;/video&gt;` : `&lt;img src="${url}" class="gm-img"&gt;`;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.querySelector('.gm-info-zone').style.height = "40%";</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>let feedbackHtml = "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (adminComment || adminMedia) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>feedbackHtml = `&lt;div style="margin-top:15px; padding:12px; background:rgba(255,255,255,0.05); border:1px solid #333; border-radius:8px; position:relative;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div style="font-size:0.65rem; color:var(--neon-pink); font-weight:900; margin-bottom:8px; letter-spacing:1px; text-transform:uppercase;"&gt;QUEEN'S FEEDBACK&lt;/div&gt;`;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (adminMedia) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const isAdmVideo = adminMedia.endsWith('.mp4');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if(isAdmVideo) feedbackHtml += `&lt;video src="${adminMedia}" controls style="width:100%; border-radius:4px; margin-bottom:8px; border:1px solid #444;"&gt;&lt;/video&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>else feedbackHtml += `&lt;img src="${adminMedia}" style="width:100%; border-radius:4px; margin-bottom:8px; border:1px solid #444;"&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (adminComment) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>feedbackHtml += `&lt;div style="font-family:'Rajdhani'; color:white; font-size:0.95rem; line-height:1.4;"&gt;"${adminComment}"&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>feedbackHtml += `&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>let stickerDisplay = "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (sticker) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>stickerDisplay = `&lt;div style="display:flex; justify-content:center; margin-bottom:5px;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;img src="${sticker}" style="width:60px; height:60px; object-fit:contain; filter:drop-shadow(0 0 5px rgba(255,255,255,0.5));"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.querySelector('.gm-info-zone').innerHTML = `</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div id="modalText" class="modal-task-text" style="font-size:1.1rem; margin-bottom:10px;"&gt;${text || ""}&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>${feedbackHtml}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div style="margin-top: auto; display:flex; flex-direction:column; align-items:center; gap:5px; border-top:1px solid #333; padding-top:15px;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>${stickerDisplay}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="modal-status-label" style="font-size:0.65rem; letter-spacing:2px; color:#666;"&gt;STATUS&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="modalStatus" class="modal-status-val" style="font-size:2rem; font-weight:900; color:${statusColor}; text-shadow:${statusShadow}; letter-spacing:3px;"&gt;${status || ""}&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;button onclick="closeModal(null)" class="action-btn" style="background:#222; color:white; font-size:0.75rem; padding: 10px; margin-top: 20px;"&gt;CLOSE&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.getElementById('glassModal').classList.add('active');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function closeModal() { document.getElementById('glassModal').classList.remove('active'); }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>// --- 1. RENDER HIGHLIGHTS (Reel) ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function renderDomVideos(videos) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const reel = document.getElementById('domVideoReel');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(!reel) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(!videos || videos.length === 0) { reel.innerHTML = `&lt;div style="color:#444; font-size:0.7rem; padding:10px;"&gt;No highlights.&lt;/div&gt;`; return; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const cnt = document.getElementById('cntPosts');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(cnt) cnt.innerText = videos.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>reel.innerHTML = videos.map(item =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const mediaUrl = item.page;<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const caption = item.post || "Clip";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (!mediaUrl) return "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const thumbUrl = getOptimizedUrl(mediaUrl, 300);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>return `</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div class="hl-item" onclick="openNewsCard('${caption.replace(/'/g, "\\'")}', '', '${mediaUrl}')"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="hl-circle"&gt;&lt;img src="${thumbUrl}" class="hl-img" loading="lazy"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="hl-title"&gt;${caption}&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}).join('');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>// --- 2. RENDER FEED GRID (News) ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function renderNews(data) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const grid = document.getElementById('newsGrid');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(!grid) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>grid.innerHTML = data.map(item =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>let contentHtml = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>let icon = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const img = item.img || item.page;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const title = item.title || item.post || "UPDATE";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const body = item.content || "";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (img) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const thumb = getOptimizedUrl(img, 300);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>contentHtml = `&lt;img src="${thumb}" class="sg-img" loading="lazy"&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>icon = 'ðŸ“·';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const shortText = title ? title : "UPDATE";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>contentHtml = `&lt;div class="sg-text"&gt;${shortText}&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>icon = 'ðŸ“';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>return `</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div class="sg-item" onclick="openNewsCard('${title.replace(/'/g, "\\'")}', '${body.replace(/'/g, "\\'")}', '${img || ""}')"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="sg-icon"&gt;${icon}&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>${item.type === 'URGENT' ? '&lt;div class="sg-new"&gt;!&lt;/div&gt;' : ''}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>${contentHtml}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}).join('');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>// --- 3. HELPER: OPEN CARD MODAL ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function openNewsCard(title, body, imgUrl) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const modal = document.getElementById('glassModal');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const mediaZone = document.getElementById('modalMediaContainer');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const textZone = document.getElementById('modalText');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const statusZone = document.getElementById('modalStatus');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(imgUrl) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const isVideo = imgUrl.includes('.mp4') || imgUrl.includes('.mov');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>mediaZone.innerHTML = isVideo ? `&lt;video src="${imgUrl}" class="gm-img" controls autoplay&gt;&lt;/video&gt;` : `&lt;img src="${imgUrl}" class="gm-img"&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>mediaZone.style.display = 'flex';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>} else { mediaZone.style.display = 'none'; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>textZone.innerHTML = `&lt;h3 style="color:var(--neon-pink); font-size:1.5rem; margin-bottom:10px; line-height:1.1;"&gt;${title}&lt;/h3&gt;&lt;div style="font-family:'Rajdhani'; font-size:1rem; color:#ccc; line-height:1.4;"&gt;${body}&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>statusZone.innerText = "VIEWING";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.querySelector('.gm-content').style.maxWidth = "600px";<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(!imgUrl) document.querySelector('.gm-content').style.display = "flex";<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>modal.classList.add('active');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>async function handleEvidenceUpload(input) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (input.files &amp;&amp; input.files[0]) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>const file = input.files[0];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>const fd = new FormData(); fd.append("file", file);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>const statusEl = document.getElementById("uploadStatus"); statusEl.innerText = "Uploading...";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>const folder = userProfile.name.replace(/[^a-z0-9-_]/gi, "_").toLowerCase();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>const res = await fetch(`https://api.bytescale.com/v2/accounts/${ACCOUNT_ID}/uploads/form_data?path=/evidence/${folder}`, { method: "POST", headers: { "Authorization": `Bearer ${API_KEY}` }, body: fd });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>if (!res.ok) { statusEl.innerText = "Upload failed."; return; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>const d = await res.json();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>if (d.files &amp;&amp; d.files[0] &amp;&amp; d.files[0].fileUrl) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>window.parent.postMessage({ type: "uploadEvidence", task: currentTask.text, fileUrl: d.files[0].fileUrl, mimeType: file.type }, "*");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>finishTask(true); statusEl.innerText = "Upload complete!";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>} else { statusEl.innerText = "Upload failed (unexpected response)."; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>} catch (err) { document.getElementById("uploadStatus").innerText = "Upload failed (error)."; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>async function handleProfileUpload(input) { if(input.files &amp;&amp; input.files[0]) { const fd = new FormData(); fd.append('file', input.files[0]); fd.append('upload_preset', UPLOAD_PRESET); const res = await fetch(`https://api.cloudinary.com/v1_1/${CLOUD_NAME}/image/upload`, { method: 'POST', body: fd }); const d = await res.json(); if(d.secure_url) window.parent.postMessage({ type: "UPDATE_PROFILE_PIC", url: d.secure_url }, "*"); } }</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>function updateStats() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>document.getElementById('subName').textContent = userProfile.name;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>document.getElementById('subHierarchy').textContent = userProfile.hierarchy;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>document.getElementById('coins').textContent = gameStats.coins;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>document.getElementById('points').textContent = gameStats.points;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>// --- NEW FIELD MAPPINGS ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>if(document.getElementById('statStreak')) document.getElementById('statStreak').textContent = gameStats.taskdom_streak || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>if(document.getElementById('statTotal')) document.getElementById('statTotal').textContent = gameStats.taskdom_total_tasks || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>if(document.getElementById('statCompleted')) document.getElementById('statCompleted').textContent = gameStats.taskdom_completed_tasks || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>if(document.getElementById('statSkipped')) document.getElementById('statSkipped').textContent = stats.skippedTasks || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>if(document.getElementById('statTotalKneels')) document.getElementById('statTotalKneels').textContent = gameStats.kneelCount || 0;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>if (userProfile.joined) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>const dateObj = new Date(userProfile.joined);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>document.getElementById('slaveSinceDate').textContent = dateObj.toLocaleDateString();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>} catch(e) { document.getElementById('slaveSinceDate').textContent = "--/--/--"; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>// Leave the level/progress bar logic below this exactly as it is...</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>let nextLevel = LEVELS.find(l =&gt; l.min &gt; gameStats.points) || {name: "MAX", min: gameStats.points};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>document.getElementById('nextLevelName').innerText = nextLevel.name;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>const needed = nextLevel.min - gameStats.points;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>document.getElementById('pointsNeeded').innerText = (needed &gt; 0 ? needed : 0) + " to go";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>const prevLevel = LEVELS.slice().reverse().find(l =&gt; l.min &lt;= gameStats.points) || {min: 0};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>const range = nextLevel.min - prevLevel.min;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>const progress = range &gt; 0 ? ((gameStats.points - prevLevel.min) / range) * 100 : 100;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>document.getElementById('progressBar').style.width = Math.min(100, Math.max(0, progress)) + "%";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>updateDevotionStatus();<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function openSessionUI() { document.getElementById('sessionOverlay').classList.add('active'); document.getElementById('sessionCostDisplay').innerText = "3000"; document.querySelector('input[value="chat"]').checked = true; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function closeSessionUI() { document.getElementById('sessionOverlay').classList.remove('active'); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function updateSessionCost() { const cost = document.querySelector('input[name="sessionType"]:checked').getAttribute('data-cost'); document.getElementById('sessionCostDisplay').innerText = cost; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function submitSessionRequest() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const type = document.querySelector('input[name="sessionType"]:checked').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const cost = parseInt(document.querySelector('input[name="sessionType"]:checked').getAttribute('data-cost'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const timeSelect = document.getElementById('sessionTimeSelect');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const selectedTimeText = timeSelect.options[timeSelect.selectedIndex].text;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const selectedTimeVal = timeSelect.value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const focus = document.getElementById('sessionFocus').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(gameStats.coins &lt; cost) { triggerSound('sfx-deny'); alert("Insufficient coins."); return; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>gameStats.coins -= cost; document.getElementById('coins').textContent = gameStats.coins; triggerSound('sfx-buy');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>window.parent.postMessage({ type: "SESSION_REQUEST", sessionType: type, cost: cost, requestedTime: selectedTimeVal, requestedTimeLabel: selectedTimeText, focus: focus }, "*");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.getElementById('sessionOverlay').innerHTML = `&lt;div style="text-align:center; padding:20px; color:white;"&gt;&lt;div style="font-size:3rem; margin-bottom:10px;"&gt;âœ…&lt;/div&gt;&lt;h2 style="font-weight:bold; margin-bottom:10px; font-family:'Orbitron';"&gt;REQUEST SENT&lt;/h2&gt;&lt;p style="color:#aaa; font-family:'Rajdhani'; font-size:0.9rem;"&gt;${cost} coins held.&lt;br&gt;Waiting for Queen's confirmation.&lt;/p&gt;&lt;button onclick="location.reload()" class="action-btn" style="margin-top:20px; font-size:0.7rem;"&gt;CLOSE&lt;/button&gt;&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function sendCoins(amount, category = "Tribute") {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// --- MOCK POOR USERS ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (gameStats.coins &lt; amount) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>triggerSound('sfx-deny');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// Insert Fake Message</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const mocks = ["Too poor.", "Earn it first.", "Empty pockets?", "Pathetic wallet."];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const text = mocks[Math.floor(Math.random() * mocks.length)];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const chatContent = document.getElementById('chatContent');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>chatContent.innerHTML += `&lt;div class="msg-row system-row"&gt;&lt;div class="msg-system sys-red"&gt;&lt;svg class="sys-icon"&gt;&lt;use href="#icon-close"&gt;&lt;/use&gt;&lt;/svg&gt;${text}&lt;/div&gt;&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>document.getElementById('chatBox').scrollTop = document.getElementById('chatBox').scrollHeight;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// -----------------------</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (category !== "TAX") { triggerSound('coinSound'); triggerCoinShower(); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>window.parent.postMessage({ type: "SEND_COINS", amount: amount, category: category }, "*");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const btns = document.querySelectorAll('.coin-btn');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>btns.forEach(b =&gt; { b.disabled = true; b.style.opacity = '0.5'; });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>setTimeout(() =&gt; { btns.forEach(b =&gt; { b.disabled = false; b.style.opacity = '1'; }); }, 1500);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function buyRealCoins(amount) { triggerSound('sfx-buy'); window.parent.postMessage({ type: "INITIATE_STRIPE_PAYMENT", amount: amount }, "*"); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function triggerCoinShower() { for(let i=0; i&lt;40; i++) { const coin = document.createElement('div'); coin.className = 'coin-particle'; coin.innerHTML = `&lt;svg style="width:100%; height:100%; fill:gold;"&gt;&lt;use href="#icon-coin"&gt;&lt;/use&gt;&lt;/svg&gt;`; coin.style.setProperty('--tx', `${Math.random()*200-100}vw`); coin.style.setProperty('--ty', `${-(Math.random()*80+20)}vh`); document.body.appendChild(coin); setTimeout(() =&gt; { coin.remove(); }, 2000); } }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function breakGlass(e) { if(e) e.stopPropagation(); const overlay = document.getElementById('specialGlassOverlay'); if (overlay.classList.contains('active')) { overlay.classList.remove('active'); window.parent.postMessage({ type: "GLASS_BROKEN" }, "*"); } }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function cleanHTML(html) { if(!html) return ""; let text = html.replace(/&lt;br\s*\/?&gt;/gi, "\n").replace(/&lt;\/p&gt;/gi, "\n"); text = text.replace(/&lt;[^&gt;]+&gt;/g, ""); const txt = document.createElement("textarea"); txt.innerHTML = text; return txt.value.trim(); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function filterStore(cat, el) { document.querySelectorAll('.cat-pill').forEach(p =&gt; p.classList.remove('active')); el.classList.add('active'); renderWishlist(cat); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function renderWishlist(filter) { const grid = document.getElementById('storeGrid'); if(!grid) return; const items = filter === 'all' ? WISHLIST_ITEMS : WISHLIST_ITEMS.filter(i =&gt; i.cat.includes(filter.toLowerCase())); grid.innerHTML = items.map(item =&gt; { const canAfford = gameStats.coins &gt;= item.price; return `&lt;div class="store-item ${canAfford?'can-afford':'locked'}"&gt;&lt;div class="si-img-box"&gt;&lt;img src="${item.img}" class="si-img"&gt;&lt;div class="si-price"&gt;${item.price} ðŸª™&lt;/div&gt;&lt;/div&gt;&lt;div class="si-info"&gt;&lt;div class="si-name"&gt;${item.name}&lt;/div&gt;&lt;button id="btn-${item.id}" class="si-btn" onclick="buyItem('${item.id}')"&gt;&lt;span&gt;${canAfford?'ðŸ”“':'ðŸ”’'}&lt;/span&gt; ${canAfford?'BUY NOW':'LOCKED'}&lt;/button&gt;&lt;/div&gt;&lt;/div&gt;`; }).join(''); }</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function buyItem(id) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const item = WISHLIST_ITEMS.find(i =&gt; i.id == id); if(!item) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (gameStats.coins &gt;= item.price) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>gameStats.coins -= item.price; document.getElementById('coins').textContent = gameStats.coins; triggerSound('sfx-buy');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>window.parent.postMessage({ type: "PURCHASE_ITEM", itemId: item.id, itemName: item.name, cost: item.price }, "*");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const btn = document.getElementById('btn-' + id);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if(btn) { btn.innerHTML = "PURCHASED"; btn.style.background = "var(--neon-green)"; btn.style.color = "black"; btn.style.borderColor = "var(--neon-green)"; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>setTimeout(() =&gt; { const activePill = document.querySelector('.cat-pill.active'); renderWishlist(activePill ? activePill.innerText.toLowerCase() : 'all'); }, 1000);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>} else { triggerSound('sfx-deny'); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function renderHierarchy(data) { const grid = document.getElementById('hierarchyGrid'); if(!grid) return; const sortedData = data.sort((a,b) =&gt; a.Order - b.Order); grid.innerHTML = sortedData.map(item =&gt; { const hasSlot = item.ContactText &amp;&amp; item.ContactText.trim() !== ""; return `&lt;div class="rank-card rounded-lg p-3 cursor-pointer ${item.CssClass || ''}" onclick="toggleDetails(this)"&gt;&lt;div class="flex items-center gap-2 md:gap-4"&gt;&lt;div class="text-lg md:text-2xl"&gt;${item.Icon || ''}&lt;/div&gt;&lt;div class="flex-1 min-w-0"&gt;&lt;div class="flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3 mb-1"&gt;&lt;h3 class="text-xl font-semibold text-gray-300" style="font-family: 'Orbitron', monospace;"&gt;${item.Title}&lt;/h3&gt;&lt;div class="flex flex-row flex-wrap gap-2"&gt;&lt;span class="duty-chip"&gt;POINTS: ${item.Points}&lt;/span&gt;${hasSlot ? `&lt;span class="duty-chip"&gt;${item.ContactText}&lt;/span&gt;` : ''}&lt;/div&gt;&lt;/div&gt;&lt;p class="text-gray-300 text-xs md:text-sm"&gt;${item.Description || ''}&lt;/p&gt;&lt;/div&gt;&lt;div class="text-gray-400 text-sm flex-shrink-0"&gt;â–¼&lt;/div&gt;&lt;/div&gt;&lt;div class="details mt-4 cms-content"&gt;&lt;div style="border-bottom:1px solid #333; padding-bottom:10px; margin-bottom:10px;"&gt;&lt;strong class="neon-pink-text" style="font-size:0.8rem;"&gt;STATUS&lt;/strong&gt;&lt;p&gt;${item.StatusText}&lt;/p&gt;&lt;/div&gt;&lt;div style="border-bottom:1px solid #333; padding-bottom:10px; margin-bottom:10px;"&gt;&lt;strong class="neon-text" style="font-size:0.8rem;"&gt;PROTOCOL&lt;/strong&gt;&lt;div&gt;${item.ProtocolText}&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;strong class="silver-text" style="font-size:0.8rem;"&gt;DUTIES&lt;/strong&gt;&lt;div&gt;${item.DutiesText}&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;`; }).join(''); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function toggleDetails(card) { const details = card.querySelector('.details'); const arrow = card.querySelector('.text-gray-400'); document.querySelectorAll('.rank-card').forEach(otherCard =&gt; { if (otherCard !== card) { const otherDetails = otherCard.querySelector('.details'); const otherArrow = otherCard.querySelector('.text-gray-400'); if(otherDetails) otherDetails.classList.remove('show'); otherCard.classList.remove('expanded'); if(otherArrow) otherArrow.textContent = 'â–¼'; } }); if (details.classList.contains('show')) { details.classList.remove('show'); card.classList.remove('expanded'); arrow.textContent = 'â–¼'; } else { details.classList.add('show'); card.classList.add('expanded'); arrow.textContent = 'â–²'; } }</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function migrateGameStatsToStats(gameStats, stats) { return { ...stats, approvedTasks: Math.max(stats.approvedTasks, gameStats.completedTasks || 0), dailyCompletedTasks: Math.max(stats.dailyCompletedTasks, gameStats.completedTasks || 0), dailyStreak: Math.max(stats.dailyStreak, gameStats.currentStreak || 0), dailyScore: Math.max(stats.dailyScore, gameStats.points || 0), monthlyTotalTasks: Math.max(stats.monthlyTotalTasks, gameStats.totalTasks || 0), monthlyScore: Math.max(stats.monthlyScore, gameStats.points || 0) }; }</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>setInterval(() =&gt; { window.parent.postMessage({ type: "heartbeat", view: currentView }, "*"); }, 3000);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>async function handleAdminUpload(input) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (input.files &amp;&amp; input.files[0]) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const file = input.files[0];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const isVideo = file.type.startsWith('video') || file.name.match(/\.(mp4|mov|webm)$/i);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const fd = new FormData();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>fd.append("file", file);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// Visual feedback</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const btn = document.querySelector('.btn-plus');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const oldText = btn.innerText;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>btn.innerText = "â³";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const res = await fetch(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>`https://api.bytescale.com/v2/accounts/${ACCOUNT_ID}/uploads/form_data?path=/admin`,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>{ method: "POST", headers: { "Authorization": `Bearer ${API_KEY}` }, body: fd }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (!res.ok) {<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>console.error("Upload failed");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>btn.innerText = oldText;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>return;<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const d = await res.json();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (d.files &amp;&amp; d.files[0] &amp;&amp; d.files[0].fileUrl) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>let finalUrl = d.files[0].fileUrl;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// --- VIDEO FIX: Add #.mp4 tag ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (isVideo) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>finalUrl = finalUrl + "#.mp4";<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// --------------------------------</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>window.parent.postMessage({ type: "SEND_CHAT_TO_BACKEND", text: finalUrl }, "*")</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>btn.innerText = oldText;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>} catch (err) { console.error("Error", err); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>// --- UPDATED DEVOTION LOGIC (1 HOUR TIMER) ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const COOLDOWN_MINUTES = 60; // 1 Hour</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let lastWorshipTime = 0;<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let isLocked = false;<span class="Apple-converted-space">Â </span></span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>// --- 1. THE TIMER LOOP (Runs every second) ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>setInterval(updateDevotionStatus, 1000);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function updateDevotionStatus() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const btn = document.getElementById('btn');<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const txtMain = document.getElementById('txt-main');<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const txtSub = document.getElementById('txt-sub');<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const fill = document.getElementById('fill');<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const dailyIdEl = document.getElementById('dailyRandomId');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(!btn || !txtMain || !txtSub || !fill) return;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// 1. Dashboard Sync (Admin Logic)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const now = new Date();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const seed = now.getUTCFullYear() * 10000 + (now.getUTCMonth() + 1) * 100 + now.getUTCDate();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const x = Math.sin(seed) * 10000;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const code = Math.floor((x - Math.floor(x)) * 9000) + 1000;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if(dailyIdEl) dailyIdEl.innerText = "#" + code;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// 2. Today's Counter from database</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const count = gameStats.todayKneeling || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>txtSub.innerText = `TODAY KNEELING: ${count}`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>txtSub.style.color = "#888"; // Keep this label grey as requested</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const timeNow = Date.now();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const diffMs = timeNow - lastWorshipTime;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const cooldownMs = COOLDOWN_MINUTES * 60 * 1000;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (lastWorshipTime &gt; 0 &amp;&amp; diffMs &lt; cooldownMs) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>isLocked = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const minutesLeft = Math.ceil((cooldownMs - diffMs) / 60000);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>txtMain.innerText = `NEXT KNEELING IN: ${minutesLeft} min`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>txtMain.style.color = "#888";<span class="Apple-converted-space">Â </span></span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// --- UPDATED: DIFFERENT SIZE FOR MOBILE VS DESKTOP ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// If screen is 1024px or wider, use 0.25rem (Desktop). Else use 0.35rem (Mobile).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>txtSub.style.fontSize = (window.innerWidth &gt;= 1024) ? "0.25rem" : "0.35rem";<span class="Apple-converted-space">Â </span></span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>btn.style.opacity = "0.7";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>btn.style.cursor = "not-allowed";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>fill.style.width = (100 - ((diffMs / cooldownMs) * 100)) + "%";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>isLocked = false;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>txtMain.innerText = "KNEEL";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>txtMain.style.color = "GREY";<span class="Apple-converted-space">Â </span></span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// --- RESET SIZE TO NORMAL BASED ON SCREEN ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>txtSub.style.fontSize = (window.innerWidth &gt;= 1024) ? "0.25rem" : "0.35rem";<span class="Apple-converted-space">Â </span></span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>btn.style.opacity = "0.7";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>btn.style.cursor = "pointer";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>fill.style.width = "0%";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>function handleClick() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (isLocked) return;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// --- THE NOISE FIX: Trigger it FIRST before anything else ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>triggerSound('coinSound');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// Update IDs to match your new 2-line HTML</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const fill = document.getElementById('fill');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const txtMain = document.getElementById('txt-main');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (fill) fill.style.width = "100%";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (txtMain) txtMain.innerText = "PROCESSING...";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>isLocked = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>window.parent.postMessage({ type: "WORSHIP" }, "*");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p1"><span class="s1">&lt;/script&gt;</span></p>
<p class="p1"><span class="s1">&lt;/body&gt;</span></p>
<p class="p1"><span class="s1">&lt;/html&gt;</span></p>
</body>
</html>
